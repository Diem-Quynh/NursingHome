{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport axios from 'axios';\nimport cookies from 'themes/modules/Cookies';\nimport _ from 'lodash';\n\nvar getConfig = require('next/config')[\"default\"];\n\nvar _getConfig = getConfig(),\n    publicRuntimeConfig = _getConfig.publicRuntimeConfig;\n\nimport RequestException from './RequestException';\n\nvar Request = /*#__PURE__*/function () {\n  function Request(cookiesString) {\n    _classCallCheck(this, Request);\n\n    this.handleGlobalCallback = undefined;\n    this.handleGlobalErrorCallback = undefined;\n    this.cookies = cookiesString;\n    var token = cookies(cookiesString).get('token');\n    axios.defaults.headers.common['Authorization'] = \"Bearer \".concat(token);\n    axios.interceptors.response.use(this.handleGlobal.bind(this), this.handleGlobalError.bind(this));\n  }\n\n  _createClass(Request, [{\n    key: \"handleGlobal\",\n    value: function handleGlobal(response) {\n      if (this.handleGlobalCallback) {\n        response = this.handleGlobalCallback(response);\n      }\n\n      return response;\n    }\n  }, {\n    key: \"handleGlobalError\",\n    value: function handleGlobalError(error) {\n      if (this.handleGlobalErrorCallback) {\n        error = this.handleGlobalErrorCallback(error);\n      }\n\n      return error;\n    }\n  }, {\n    key: \"getAppUrl\",\n    value: function getAppUrl() {\n      //return window.location.origin + \"/\"\n      return publicRuntimeConfig.API_HOST;\n    }\n  }, {\n    key: \"beforeRequest\",\n    value: function beforeRequest(_ref) {\n      var url = _ref.url,\n          data = _ref.data;\n    }\n  }, {\n    key: \"afterRequest\",\n    value: function afterRequest(result) {\n      if (!result) throw new RequestException(-1, \"Unable connect to server!\");\n\n      var code = _.get(result, \"data.code\", -1);\n\n      var message = _.get(result, \"data.message\", \"\");\n\n      var data = _.get(result, \"data.data\");\n\n      if (code != 200) {\n        throw new RequestException(code, message, data);\n      }\n\n      return data;\n    }\n  }, {\n    key: \"get\",\n    value: function get(url) {\n      var data,\n          result,\n          _args = arguments;\n      return _regeneratorRuntime.async(function get$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n              this.beforeRequest({\n                url: url,\n                data: data\n              });\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(axios.get(this.getAppUrl() + url, {\n                params: data\n              }));\n\n            case 4:\n              result = _context.sent;\n              return _context.abrupt(\"return\", this.afterRequest(result));\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"post\",\n    value: function post(url, data) {\n      var result;\n      return _regeneratorRuntime.async(function post$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              this.beforeRequest({\n                url: url,\n                data: data\n              });\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(axios.post(this.getAppUrl() + url, data));\n\n            case 3:\n              result = _context2.sent;\n              return _context2.abrupt(\"return\", this.afterRequest(result));\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"put\",\n    value: function put(url, data) {\n      var result;\n      return _regeneratorRuntime.async(function put$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              this.beforeRequest({\n                url: url,\n                data: data\n              });\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(axios.put(this.getAppUrl() + url, data));\n\n            case 3:\n              result = _context3.sent;\n              return _context3.abrupt(\"return\", this.afterRequest(result));\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(url, data) {\n      var result;\n      return _regeneratorRuntime.async(function _delete$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              this.beforeRequest({\n                url: url,\n                data: data\n              });\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(axios[\"delete\"](this.getAppUrl() + url, {\n                params: data\n              }));\n\n            case 3:\n              result = _context4.sent;\n              return _context4.abrupt(\"return\", this.afterRequest(result));\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }]);\n\n  return Request;\n}();\n\nexport { Request as default };","map":{"version":3,"sources":["E:/DATN/nursinghome/themes/modules/Request.js"],"names":["axios","cookies","_","getConfig","require","publicRuntimeConfig","RequestException","Request","cookiesString","handleGlobalCallback","undefined","handleGlobalErrorCallback","token","get","defaults","headers","common","interceptors","response","use","handleGlobal","bind","handleGlobalError","error","API_HOST","url","data","result","code","message","beforeRequest","getAppUrl","params","afterRequest","post","put"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport cookies from 'themes/modules/Cookies';\r\nimport _ from 'lodash'\r\nconst getConfig = require('next/config').default\r\nconst { publicRuntimeConfig } = getConfig();\r\nimport RequestException from './RequestException'\r\n\r\nexport default class Request {\r\n  constructor(cookiesString) {\r\n    this.handleGlobalCallback = undefined;\r\n    this.handleGlobalErrorCallback = undefined;\r\n    this.cookies = cookiesString\r\n    const token = cookies(cookiesString).get('token')\r\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    axios.interceptors.response.use(this.handleGlobal.bind(this), this.handleGlobalError.bind(this));\r\n  }\r\n\r\n  handleGlobal(response) {\r\n    if (this.handleGlobalCallback) {\r\n      response = this.handleGlobalCallback(response)\r\n    }\r\n    return response\r\n  }\r\n\r\n  handleGlobalError(error) {\r\n    if (this.handleGlobalErrorCallback) {\r\n      error = this.handleGlobalErrorCallback(error)\r\n    }\r\n    return error\r\n  }\r\n\r\n  getAppUrl() {\r\n    //return window.location.origin + \"/\"\r\n    return publicRuntimeConfig.API_HOST\r\n  }\r\n  beforeRequest({ url, data }) {\r\n\r\n  }\r\n  afterRequest(result) {\r\n    if (!result) throw new RequestException(-1, \"Unable connect to server!\")\r\n    const code = _.get(result, \"data.code\", -1)\r\n    const message = _.get(result, \"data.message\", \"\")\r\n    const data = _.get(result, \"data.data\")\r\n    if (code != 200) {\r\n      throw new RequestException(code, message, data)\r\n    }\r\n    return data\r\n  }\r\n\r\n  async get(url, data = {}) {\r\n    this.beforeRequest({ url, data })\r\n    let result = await axios.get(this.getAppUrl() + url, { params: data });\r\n    return this.afterRequest(result)\r\n  }\r\n  async post(url, data) {\r\n    this.beforeRequest({ url, data })\r\n    let result = await axios.post(this.getAppUrl() + url, data);\r\n    return this.afterRequest(result)\r\n  }\r\n  async put(url, data) {\r\n    this.beforeRequest({ url, data })\r\n    let result = await axios.put(this.getAppUrl() + url, data);\r\n    return this.afterRequest(result)\r\n  }\r\n  async delete(url, data) {\r\n    this.beforeRequest({ url, data })\r\n    let result = await axios.delete(this.getAppUrl() + url, { params: data });\r\n    return this.afterRequest(result)\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}