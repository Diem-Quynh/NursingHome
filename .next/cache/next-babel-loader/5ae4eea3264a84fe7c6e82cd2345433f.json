{"ast":null,"code":"var charToNum = {\n  C: 8,\n  R: 4,\n  U: 2,\n  D: 1\n};\n\nvar crudToDec = function crudToDec(text) {\n  return text.toUpperCase().split(\"\").reduce(function (total, _char) {\n    return total + charToNum[_char];\n  }, 0);\n};\n\nvar decToCrud = function decToCrud(dec) {\n  var result = \"\";\n\n  var _char2;\n\n  for (_char2 in charToNum) {\n    if ((dec & charToNum[_char2]) == charToNum[_char2]) result += _char2;\n  }\n\n  return result;\n};\n\nvar hasPermission = function hasPermission(requirePermission, userPermission) {\n  return (userPermission & requirePermission) === requirePermission;\n};\n\nvar checkPermission = function checkPermission(permissions, userPermissions) {\n  var showError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  if (!permissions) return true;\n\n  for (var permission in permissions) {\n    var requirePermission = crudToDec(permissions[permission]);\n    var rootPermission = userPermissions[\"root\"] || 0;\n    var userPermission = userPermissions[permission] || 0;\n    userPermission = userPermission | rootPermission;\n\n    if (!hasPermission(requirePermission, userPermission)) {\n      if (!showError) return false;\n      return {\n        error: true,\n        permission: permission,\n        requirePermission: decToCrud(requirePermission),\n        userPermission: decToCrud(userPermission)\n      };\n    }\n  }\n\n  return true;\n};\n\nexport { checkPermission, hasPermission, crudToDec, decToCrud };","map":{"version":3,"sources":["E:/DATN/salonadmin/themes/utils/Permission.ts"],"names":["charToNum","C","R","U","D","crudToDec","text","toUpperCase","split","reduce","total","char","decToCrud","dec","result","hasPermission","requirePermission","userPermission","checkPermission","permissions","userPermissions","showError","permission","rootPermission","error"],"mappings":"AAEA,IAAMA,SAAS,GAAG;AAAEC,EAAAA,CAAC,EAAE,CAAL;AAAQC,EAAAA,CAAC,EAAE,CAAX;AAAcC,EAAAA,CAAC,EAAE,CAAjB;AAAoBC,EAAAA,CAAC,EAAE;AAAvB,CAAlB;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD,EAAe;AAC7B,SAAOA,IAAI,CAACC,WAAL,GAAmBC,KAAnB,CAAyB,EAAzB,EAA6BC,MAA7B,CAAoC,UAACC,KAAD,EAAgBC,KAAhB;AAAA,WAAgDD,KAAK,GAAGV,SAAS,CAACW,KAAD,CAAjE;AAAA,GAApC,EAA6G,CAA7G,CAAP;AAEH,CAHD;;AAIA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAiB;AAC/B,MAAIC,MAAM,GAAG,EAAb;;AACA,MAAIH,MAAJ;;AACA,OAAKA,MAAL,IAAaX,SAAb,EAAwB;AACpB,QAAI,CAACa,GAAG,GAAGb,SAAS,CAACW,MAAD,CAAhB,KAA2BX,SAAS,CAACW,MAAD,CAAxC,EAAgDG,MAAM,IAAIH,MAAV;AACnD;;AACD,SAAOG,MAAP;AACH,CAPD;;AASA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,iBAAD,EAA4BC,cAA5B,EAAuD;AACzE,SAAO,CAACA,cAAc,GAAGD,iBAAlB,MAAyCA,iBAAhD;AACD,CAFH;;AAIA,IAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACC,WAAD,EAAmBC,eAAnB,EAAwE;AAAA,MAA/BC,SAA+B,uEAAV,KAAU;AAC5F,MAAG,CAACF,WAAJ,EAAiB,OAAO,IAAP;;AACjB,OAAK,IAAIG,UAAT,IAAuBH,WAAvB,EAAoC;AAChC,QAAMH,iBAAiB,GAAGX,SAAS,CAACc,WAAW,CAACG,UAAD,CAAZ,CAAnC;AACA,QAAMC,cAAc,GAAGH,eAAe,CAAC,MAAD,CAAf,IAA2B,CAAlD;AACA,QAAIH,cAAc,GAAGG,eAAe,CAACE,UAAD,CAAf,IAA+B,CAApD;AACAL,IAAAA,cAAc,GAAGA,cAAc,GAAGM,cAAlC;;AACA,QAAI,CAACR,aAAa,CAACC,iBAAD,EAAoBC,cAApB,CAAlB,EAAuD;AACnD,UAAI,CAACI,SAAL,EAAgB,OAAO,KAAP;AAChB,aAAO;AACHG,QAAAA,KAAK,EAAE,IADJ;AAEHF,QAAAA,UAAU,EAAEA,UAFT;AAGHN,QAAAA,iBAAiB,EAAEJ,SAAS,CAACI,iBAAD,CAHzB;AAIHC,QAAAA,cAAc,EAAEL,SAAS,CAACK,cAAD;AAJtB,OAAP;AAMH;AACJ;;AACD,SAAO,IAAP;AACH,CAlBD;;AAoBA,SACIC,eADJ,EAEIH,aAFJ,EAGIV,SAHJ,EAIIO,SAJJ","sourcesContent":["import routeConfig from '../_routes.json'\r\n\r\nconst charToNum = { C: 8, R: 4, U: 2, D: 1 }\r\nconst crudToDec = (text: any) => {\r\n    return text.toUpperCase().split(\"\").reduce((total: number, char: 'C' | 'R' | 'U' | 'D') => total + charToNum[char], 0)\r\n\r\n}\r\nconst decToCrud = (dec: number) => {\r\n    let result = \"\";\r\n    let char: 'C' | 'R' | 'U' | 'D'\r\n    for (char in charToNum) {\r\n        if ((dec & charToNum[char]) == charToNum[char]) result += char\r\n    }\r\n    return result\r\n}\r\n\r\nconst hasPermission = (requirePermission: number, userPermission: number) => {\r\n    return (userPermission & requirePermission) === requirePermission\r\n  }\r\n\r\nconst checkPermission = (permissions: any, userPermissions: any, showError: boolean = false) => {\r\n    if(!permissions) return true\r\n    for (let permission in permissions) {\r\n        const requirePermission = crudToDec(permissions[permission]);\r\n        const rootPermission = userPermissions[\"root\"] || 0\r\n        let userPermission = userPermissions[permission] || 0\r\n        userPermission = userPermission | rootPermission\r\n        if (!hasPermission(requirePermission, userPermission)) {\r\n            if (!showError) return false;\r\n            return {\r\n                error: true,\r\n                permission: permission,\r\n                requirePermission: decToCrud(requirePermission),\r\n                userPermission: decToCrud(userPermission)\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport {\r\n    checkPermission,\r\n    hasPermission,\r\n    crudToDec,\r\n    decToCrud\r\n}\r\n"]},"metadata":{},"sourceType":"module"}