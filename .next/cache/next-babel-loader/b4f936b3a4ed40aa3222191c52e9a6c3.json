{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"E:\\\\DATN\\\\nursinghome\\\\pages\\\\_app.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport App, { Container } from 'next/app';\nimport { appWithTranslation } from 'themes/modules/I18n';\nimport { Provider } from 'react-redux';\nimport { makeStore, setStore } from 'themes/components/Store';\nimport nextCookie from 'next-cookies';\nimport withRedux from \"next-redux-wrapper\";\nimport Loading from 'themes/components/Loading';\nimport 'themes/less/custom-ant-theme.less';\nimport 'themes/less/home.less';\nimport 'themes/less/login.less';\nimport 'themes/less/admin.less';\nimport _ from 'lodash';\nimport Error403Page from 'themes/components/Errors/403';\nimport { ScrollToTopButton } from 'themes/components/Utils';\nimport { checkPermission, decToCrud } from 'themes/utils/Permission';\nimport getConfig from 'next/config';\n\nvar _getConfig = getConfig(),\n    publicRuntimeConfig = _getConfig.publicRuntimeConfig;\n\nvar MyApp = /*#__PURE__*/function (_App) {\n  _inherits(MyApp, _App);\n\n  var _super = _createSuper(MyApp);\n\n  function MyApp() {\n    _classCallCheck(this, MyApp);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(MyApp, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps,\n          store = _this$props.store,\n          error = _this$props.error,\n          permission = _this$props.permission,\n          requirePermission = _this$props.requirePermission,\n          userPermission = _this$props.userPermission;\n      return __jsx(React.Fragment, null, __jsx(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 9\n        }\n      }), __jsx(Provider, {\n        store: store,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 9\n        }\n      }, error ? __jsx(Error403Page, {\n        permission: permission,\n        requirePermission: requirePermission,\n        userPermission: userPermission,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }\n      }) : __jsx(Component, _extends({}, pageProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 13\n        }\n      })), __jsx(ScrollToTopButton, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }\n      })));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(AppContext) {\n      var Component, ctx, pagePermissions, cookies, userPermissions, resultPermission, newComponent, appProps, namespacesRequired;\n      return _regeneratorRuntime.async(function getInitialProps$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Component = AppContext.Component, ctx = AppContext.ctx; //check permission\n\n              pagePermissions = Component.permissions;\n              cookies = nextCookie(ctx);\n              userPermissions = _.get(cookies, \"user.permissions\", {}); // const userPermissions = _.get(cookies, \"admin.permissions\", {})\n\n              resultPermission = {};\n              newComponent = Component;\n\n              if (pagePermissions) {\n                resultPermission = checkPermission(pagePermissions, userPermissions, true);\n                if (resultPermission != true) newComponent = Error403Page;\n              }\n\n              _context.next = 9;\n              return _regeneratorRuntime.awrap(App.getInitialProps(_objectSpread({}, AppContext, {\n                Component: newComponent\n              })));\n\n            case 9:\n              appProps = _context.sent;\n              // calls page's `getInitialProps` and fills `appProps.pageProps`\n              // ctx.store.dispatch(setStore(\"auth\", cookies.user));\n              ctx.store.dispatch(setStore(\"auth\", cookies.admin));\n              ctx.store.dispatch(setStore(\"cookies\", cookies));\n              ctx.store.dispatch(setStore(\"publicRuntimeConfig\", publicRuntimeConfig));\n              namespacesRequired = appProps.namespacesRequired || [];\n              return _context.abrupt(\"return\", _objectSpread({}, resultPermission, {}, appProps, {\n                // auth: cookies.user,\n                auth: cookies.admin,\n                cookies: cookies,\n                namespacesRequired: [].concat(_toConsumableArray(namespacesRequired), ['common', 'pages', 'menu'])\n              }));\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }]);\n\n  return MyApp;\n}(App);\n\nexport default withRedux(makeStore)(appWithTranslation(MyApp));","map":{"version":3,"sources":["E:/DATN/nursinghome/pages/_app.jsx"],"names":["React","App","Container","appWithTranslation","Provider","makeStore","setStore","nextCookie","withRedux","Loading","_","Error403Page","ScrollToTopButton","checkPermission","decToCrud","getConfig","publicRuntimeConfig","MyApp","props","Component","pageProps","store","error","permission","requirePermission","userPermission","AppContext","ctx","pagePermissions","permissions","cookies","userPermissions","get","resultPermission","newComponent","getInitialProps","appProps","dispatch","admin","namespacesRequired","auth"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport App, { Container } from 'next/app';\r\nimport { appWithTranslation } from 'themes/modules/I18n'\r\nimport { Provider } from 'react-redux'\r\nimport { makeStore, setStore } from 'themes/components/Store'\r\nimport nextCookie from 'next-cookies'\r\nimport withRedux from \"next-redux-wrapper\";\r\nimport Loading from 'themes/components/Loading'\r\nimport 'themes/less/custom-ant-theme.less';\r\nimport 'themes/less/home.less'\r\nimport 'themes/less/login.less'\r\nimport 'themes/less/admin.less'\r\nimport _ from 'lodash'\r\n\r\nimport Error403Page from 'themes/components/Errors/403'\r\nimport { ScrollToTopButton } from 'themes/components/Utils'\r\nimport { checkPermission, decToCrud } from 'themes/utils/Permission'\r\nimport getConfig from 'next/config'\r\nconst { publicRuntimeConfig } = getConfig();\r\n\r\n\r\nclass MyApp extends App {\r\n\r\n  static async getInitialProps(AppContext) {\r\n    const { Component, ctx } = AppContext\r\n\r\n    //check permission\r\n    const pagePermissions = Component.permissions\r\n    const cookies = nextCookie(ctx)\r\n    const userPermissions = _.get(cookies, \"user.permissions\", {})\r\n    // const userPermissions = _.get(cookies, \"admin.permissions\", {})\r\n    let resultPermission = {}\r\n    let newComponent = Component\r\n\r\n\r\n    if (pagePermissions) {\r\n      resultPermission = checkPermission(pagePermissions, userPermissions, true);\r\n      if (resultPermission != true) newComponent = Error403Page\r\n    }\r\n\r\n    const appProps = await App.getInitialProps({\r\n      ...AppContext,\r\n      Component: newComponent\r\n    });\r\n\r\n    // calls page's `getInitialProps` and fills `appProps.pageProps`\r\n    // ctx.store.dispatch(setStore(\"auth\", cookies.user));\r\n    ctx.store.dispatch(setStore(\"auth\", cookies.admin));\r\n    ctx.store.dispatch(setStore(\"cookies\", cookies));\r\n    ctx.store.dispatch(setStore(\"publicRuntimeConfig\", publicRuntimeConfig));\r\n    let namespacesRequired = appProps.namespacesRequired || []\r\n\r\n    return {\r\n      ...resultPermission,\r\n      ...appProps,\r\n      // auth: cookies.user,\r\n      auth: cookies.admin,\r\n      cookies: cookies,\r\n      namespacesRequired: [...namespacesRequired, 'common', 'pages', 'menu'],\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { Component, pageProps, store, error, permission, requirePermission, userPermission } = this.props;\r\n    return (\r\n      <>\r\n        <Loading />\r\n        <Provider store={store}>\r\n          {error ?\r\n            <Error403Page permission={permission} requirePermission={requirePermission} userPermission={userPermission} />\r\n            :\r\n            <Component {...pageProps} />\r\n          }\r\n          <ScrollToTopButton />\r\n        </Provider>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRedux(makeStore)(appWithTranslation(MyApp))"]},"metadata":{},"sourceType":"module"}